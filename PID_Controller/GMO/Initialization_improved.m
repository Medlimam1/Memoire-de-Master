%___________________________________________________________________%
%               GMO: محسّن المتوسط الهندسي                           %
%                                                                   %
% تم تطويره في MATLAB R2016b                                        %
%                                                                   %
% البريد الإلكتروني: elimam_mohamed@univ-biskra.dz                   %
%                medlimame9@gmail.com                               %
%                                                                   %
% الصفحة الشخصية: https://www.linkedin.com/in/mohamed-el-imam-434321335/ %
%                                                                   %
% الورقة البحثية الرئيسية:                                          %
% Rezaei, F., Safavi, H.R., Abd Elaziz, M. et al.                   %
% GMO: محسّن المتوسط الهندسي لحل المشكلات الهندسية.                   %
% Soft Comput (2023). https://doi.org/10.1007/s00500-023-08202-z    %
%___________________________________________________________________%

% دالة التهيئة المحسنة لخوارزمية GMO
function [pp, pv] = Initialization_improved(np, nx, varmax, varmin, velmax, velmin)
%% Initialization_improved - تهيئة المواضع والسرعات الأولية لخوارزمية GMO
%
% الإدخالات:
%   np      - عدد الأفراد في المجتمع (حجم السكان)
%   nx      - عدد المتغيرات (أبعاد المسألة، عادة 3 لـ [Kp, Ki, Kd])
%   varmax  - الحد الأعلى للمتغيرات (مصفوفة 1×nx)
%   varmin  - الحد الأدنى للمتغيرات (مصفوفة 1×nx)
%   velmax  - الحد الأعلى للسرعة (مصفوفة 1×nx)
%   velmin  - الحد الأدنى للسرعة (مصفوفة 1×nx)
%
% الإخراجات:
%   pp      - مصفوفة المواضع الأولية (np×nx)
%   pv      - مصفوفة السرعات الأولية (np×nx)
%
% الوصف:
%   تقوم هذه الدالة بتهيئة المواضع والسرعات الأولية لمجتمع الأفراد في خوارزمية GMO.
%   يتم توليد المواضع بشكل عشوائي ضمن الحدود المحددة [varmin, varmax].
%   يتم توليد السرعات بشكل عشوائي ضمن الحدود المحددة [velmin, velmax].
%   تستخدم استراتيجية التوزيع العشوائي المنتظم لضمان تغطية فضاء البحث بشكل جيد.

% تهيئة مصفوفات المواضع والسرعات
pp = zeros(np, nx);
pv = zeros(np, nx);

% توليد المواضع والسرعات الأولية لكل فرد
for j = 1:np
    % توليد المواضع الأولية بشكل عشوائي ضمن الحدود [varmin, varmax]
    pp(j, 1:nx) = (varmax - varmin) .* rand(1, nx) + varmin;
    
    % توليد السرعات الأولية بشكل عشوائي ضمن الحدود [velmin, velmax]
    pv(j, 1:nx) = (velmax - velmin) .* rand(1, nx) + velmin;
end

% التحقق من أن المواضع ضمن الحدود المسموحة
pp = max(min(pp, repmat(varmax, np, 1)), repmat(varmin, np, 1));

% التحقق من أن السرعات ضمن الحدود المسموحة
pv = max(min(pv, repmat(velmax, np, 1)), repmat(velmin, np, 1));

end
